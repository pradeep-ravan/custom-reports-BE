<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Power BI Integration</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      padding-top: 20px;
      background-color: #f5f5f5;
    }
    .powerbi-container {
      height: 700px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      overflow: hidden;
      background-color: white;
    }
    .powerbi-header {
      background-color: #0d6efd;
      color: white;
      padding: 15px;
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
    }
    iframe {
      border: none;
      width: 100%;
      height: calc(100% - 60px);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1>Power BI Dashboard</h1>
      <a href="/" class="btn btn-primary">
        <i class="bi bi-arrow-left"></i> Back to Reports
      </a>
    </div>
    
    <div class="row">
      <div class="col-12">
        <div class="powerbi-container">
          <div class="powerbi-header">
            <h4 class="mb-0">Custom Reports Dashboard</h4>
          </div>
          
          <!-- 
            In a real implementation, this would be replaced with actual Power BI embed code.
            Below is a placeholder that demonstrates the integration concept.
          -->
          <div class="p-4">
            <div class="alert alert-info mb-4">
              <h5>Power BI Integration Instructions</h5>
              <p>In a production environment, this page would contain an embedded Power BI report using the Power BI JavaScript SDK. The integration would involve:</p>
              <ol>
                <li>Setting up a Power BI workspace in the Power BI service</li>
                <li>Creating a report using the custom data exported from this application</li>
                <li>Configuring the Power BI Embed API credentials</li>
                <li>Using the Power BI JavaScript SDK to embed the report in this page</li>
              </ol>
              <p>Below is a mock-up of what the embedded Power BI dashboard would look like.</p>
            </div>
            
            <div class="card mb-4">
              <div class="card-header bg-light">
                <h5 class="mb-0">Custom Reports Overview</h5>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-3 text-center mb-3">
                    <div style="font-size: 2.5rem; font-weight: bold; color: #0d6efd;">85%</div>
                    <div>Completion Rate</div>
                  </div>
                  <div class="col-md-3 text-center mb-3">
                    <div style="font-size: 2.5rem; font-weight: bold; color: #0d6efd;">76</div>
                    <div>Avg. Score</div>
                  </div>
                  <div class="col-md-3 text-center mb-3">
                    <div style="font-size: 2.5rem; font-weight: bold; color: #0d6efd;">45</div>
                    <div>Avg. Minutes</div>
                  </div>
                  <div class="col-md-3 text-center mb-3">
                    <div style="font-size: 2.5rem; font-weight: bold; color: #0d6efd;">3.2</div>
                    <div>Avg. Attempts</div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <div class="card mb-4">
                  <div class="card-header bg-light">
                    <h5 class="mb-0">Score Distribution</h5>
                  </div>
                  <div class="card-body">
                    <img src="https://via.placeholder.com/500x250?text=Score+Distribution+Chart" alt="Score Distribution" class="img-fluid" />
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card mb-4">
                  <div class="card-header bg-light">
                    <h5 class="mb-0">Completion by Microskill</h5>
                  </div>
                  <div class="card-body">
                    <img src="https://via.placeholder.com/500x250?text=Completion+by+Microskill+Chart" alt="Completion by Microskill" class="img-fluid" />
                  </div>
                </div>
              </div>
            </div>
            
            <div class="card">
              <div class="card-header bg-light">
                <h5 class="mb-0">Detailed Metrics Table</h5>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-striped">
                    <thead>
                      <tr>
                        <th>Microskill</th>
                        <th>Completion Rate</th>
                        <th>Avg. Score</th>
                        <th>Avg. Time</th>
                        <th>Avg. Attempts</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>JavaScript</td>
                        <td>92%</td>
                        <td>82</td>
                        <td>35 min</td>
                        <td>2.1</td>
                      </tr>
                      <tr>
                        <td>Python</td>
                        <td>88%</td>
                        <td>79</td>
                        <td>42 min</td>
                        <td>2.8</td>
                      </tr>
                      <tr>
                        <td>Machine Learning</td>
                        <td>76%</td>
                        <td>71</td>
                        <td>58 min</td>
                        <td>3.5</td>
                      </tr>
                      <tr>
                        <td>Data Visualization</td>
                        <td>81%</td>
                        <td>75</td>
                        <td>40 min</td>
                        <td>2.3</td>
                      </tr>
                      <tr>
                        <td>API Integration</td>
                        <td>85%</td>
                        <td>77</td>
                        <td>38 min</td>
                        <td>2.7</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="mt-5 mb-5">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">Power BI Integration Steps</h4>
        </div>
        <div class="card-body">
          <ol>
            <li class="mb-3">
              <strong>Create a Power BI Account and Workspace:</strong>
              <p>Sign up for Power BI service (free or Pro) and create a workspace for your custom reports.</p>
            </li>
            <li class="mb-3">
              <strong>Export Data from Custom Reports:</strong>
              <p>Use the "Download CSV" functionality in the custom reports to export the data.</p>
            </li>
            <li class="mb-3">
              <strong>Import Data to Power BI:</strong>
              <p>Import the CSV files into Power BI Desktop or directly to the Power BI service.</p>
            </li>
            <li class="mb-3">
              <strong>Create Reports and Dashboards:</strong>
              <p>Design visualizations, reports, and dashboards using the imported data.</p>
            </li>
            <li class="mb-3">
              <strong>Set Up Power BI Embed:</strong>
              <p>Register your application with Azure AD and set up the Power BI Embed API.</p>
              <pre><code>// Example Power BI Embed Code
const embedConfig = {
  type: 'report',
  id: '[Report ID]',
  embedUrl: 'https://app.powerbi.com/reportEmbed?reportId=[Report ID]',
  tokenType: models.TokenType.Embed,
  accessToken: '[Access Token]',
  settings: {
    navContentPaneEnabled: true,
    filterPaneEnabled: true
  }
};

const report = powerbi.embed(reportContainer, embedConfig);</code></pre>
            </li>
            <li class="mb-3">
              <strong>Implement Automatic Data Refresh:</strong>
              <p>Set up scheduled refreshes or implement real-time data updates using the Power BI API.</p>
            </li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>